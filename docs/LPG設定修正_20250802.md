---
title: LPG設定修正手順
created: '2025-08-02'
updated: '2025-08-02'
author: claudecode
tags:
- '#proj-lpg'
- '#troubleshooting'
---

# LPG設定修正手順

## 問題の概要

LPGがLacisDrawBoardsにプロキシする際、間違ったポート（3000）を使用しています。
正しいポートは80です。

### エラー内容
```
Unable to connect to: http://192.168.234.10:3000/
```

### 原因
- LPGサービスが古い設定を使用している
- 設定ファイル（/etc/lpg/config.json）は正しく80を指定している
- サービスの再起動が必要

## 修正手順

### 1. SSH接続
```bash
ssh lacis@192.168.234.2
# パスワード: [チャット内の記録を確認]
```

### 2. 現在の設定確認
```bash
# 設定ファイルの確認
cat /etc/lpg/config.json | grep -A5 "/lacisstack/boards"

# 期待される出力:
# "/lacisstack/boards": {
#   "deviceip": "192.168.234.10",
#   "port": [80],
#   "sitename": "whiteboard",
#   "ips": ["192.168.3.0/24"]
# }
```

### 3. LPGサービスの再起動
```bash
# サービスの状態確認
sudo systemctl status lpg

# サービスの再起動
sudo systemctl restart lpg

# または、Dockerコンテナの場合
docker ps | grep lpg
docker restart <container_id>
```

### 4. プロセスの確認
```bash
# LPGプロセスの確認
ps aux | grep lpg
ps aux | grep python
```

### 5. ログの確認
```bash
# システムログ
sudo journalctl -u lpg -n 50

# またはログファイル
tail -f /var/log/lpg/lpg.log
```

## 代替解決策

### A. 手動でLPGプロキシを再起動
```bash
# 現在のプロセスを停止
sudo pkill -f lpg

# 正しい設定で起動
cd /opt/lpg
sudo python3 lpg_proxy_enhanced.py
```

### B. 設定の再読み込み
```bash
# LPGに設定再読み込みシグナルを送信
sudo kill -HUP $(pgrep -f lpg)
```

## 確認方法

```bash
# LPGプロキシのテスト
curl -H "Host: akb001yebraxfqsm9y.dyndns-web.com" \
     http://192.168.234.2/lacisstack/boards/

# 期待される結果: HTMLレスポンス（200 OK）
```

## 注意事項

- LPGは設定ファイルの変更を自動的に検出するはずですが、キャッシュされている可能性があります
- サービス再起動後、数秒待ってからテストしてください
- 設定ファイルのパーミッションを確認してください（読み取り可能である必要があります）