---
title: LacisProxyGateway 開発タスク
projects:
- LPG
tags:
- '#proj-lpg'
created: '2025-07-28'
updated: '2025-07-28'
author: unknown
status: draft
---
# LacisProxyGateway 開発タスク

**― 実装タスク管理表 ―**  
作成日: 2025-07-26  
バージョン: 1.0.0

---

## 1. プロジェクト概要

### 1.1 開発フェーズ

| フェーズ | 期間 | 主要成果物 |
|----------|------|------------|
| Phase 1: 基盤構築 | 2週間 | 開発環境、基本API、認証機能 |
| Phase 2: コア機能 | 3週間 | Caddy連携、ルーティング管理 |
| Phase 3: UI実装 | 3週間 | React管理画面、全画面実装 |
| Phase 4: 運用機能 | 2週間 | ログ、監視、バックアップ |
| Phase 5: テスト・デプロイ | 2週間 | 統合テスト、本番環境構築 |

### 1.2 優先度定義

- **P0**: ブロッカー（システムが動作しない）
- **P1**: クリティカル（主要機能が使えない）
- **P2**: 重要（機能制限あり）
- **P3**: 通常（改善要望）

---

## 2. タスク一覧

### Phase 1: 基盤構築

#### TASK-001: プロジェクト初期設定
- **優先度**: P0
- **工数**: 4h
- **担当**: -
- **依存**: なし
- **内容**:
  - [ ] ディレクトリ構造作成
  - [ ] .gitignore設定
  - [ ] package.json作成
  - [ ] TypeScript設定
  - [ ] ESLint/Prettier設定

#### TASK-002: 開発環境構築
- **優先度**: P0
- **工数**: 8h
- **担当**: -
- **依存**: TASK-001
- **内容**:
  - [ ] Docker Compose設定
  - [ ] 開発用証明書生成
  - [ ] VS Code設定共有
  - [ ] 開発手順書作成

#### TASK-003: APIサーバー基盤実装
- **優先度**: P0
- **工数**: 16h
- **担当**: -
- **依存**: TASK-002
- **内容**:
  - [ ] Goプロジェクト初期化
  - [ ] HTTPサーバー実装（Echo or Gin）
  - [ ] ミドルウェア設定（CORS, Logger）
  - [ ] エラーハンドリング
  - [ ] 設定ファイル読み込み

#### TASK-004: 認証機能実装
- **優先度**: P0
- **工数**: 24h
- **担当**: -
- **依存**: TASK-003
- **内容**:
  - [ ] Argon2idハッシュ実装
  - [ ] JWT生成・検証
  - [ ] ログインAPI
  - [ ] セッション管理
  - [ ] パスワード変更API

#### TASK-005: 設定管理機能
- **優先度**: P1
- **工数**: 16h
- **担当**: -
- **依存**: TASK-003
- **内容**:
  - [ ] config.json読み書き
  - [ ] JSONスキーマ検証
  - [ ] ホットリロード実装
  - [ ] バックアップ機能（5世代）

### Phase 2: コア機能

#### TASK-006: Caddy連携実装
- **優先度**: P0
- **工数**: 32h
- **担当**: -
- **依存**: TASK-005
- **内容**:
  - [ ] Caddy Admin API クライアント
  - [ ] 設定同期機能
  - [ ] 証明書状態取得
  - [ ] エラーリカバリ

#### TASK-007: ルーティング管理API
- **優先度**: P0
- **工数**: 24h
- **担当**: -
- **依存**: TASK-005
- **内容**:
  - [ ] ドメインCRUD API
  - [ ] デバイスCRUD API
  - [ ] ルール解決ロジック
  - [ ] 設定検証

#### TASK-008: 基本セキュリティルールの実装
- **優先度**: P2
- **工数**: 8h
- **担当**: -
- **依存**: TASK-003
- **内容**:
  - [ ] LPG自体の基本的なセキュリティルール実装
  - [ ] DDoS対策の基本ルール
  - [ ] 注: VLANポリシーはOmada ACLで管理

#### TASK-009: ログ収集・転送
- **優先度**: P1
- **工数**: 20h
- **担当**: -
- **依存**: TASK-003
- **内容**:
  - [ ] アクセスログパーサー
  - [ ] JSONフォーマッタ
  - [ ] バッチ送信実装
  - [ ] ローテーション機能

### Phase 3: UI実装

#### TASK-010: React基盤セットアップ
- **優先度**: P0
- **工数**: 12h
- **担当**: -
- **依存**: TASK-001
- **内容**:
  - [ ] Vite設定
  - [ ] React Router設定
  - [ ] Primer CSS導入
  - [ ] 認証Context実装

#### TASK-011: 共通コンポーネント開発
- **優先度**: P1
- **工数**: 20h
- **担当**: -
- **依存**: TASK-010
- **内容**:
  - [ ] Layout（Header/Sidebar）
  - [ ] 認証ガード
  - [ ] エラーバウンダリ
  - [ ] ローディング表示
  - [ ] トースト通知

#### TASK-012: ログイン画面実装
- **優先度**: P0
- **工数**: 12h
- **担当**: -
- **依存**: TASK-011
- **内容**:
  - [ ] ログインフォーム
  - [ ] パスワード変更画面
  - [ ] セッション管理

#### TASK-013: Domains画面実装
- **優先度**: P1
- **工数**: 16h
- **担当**: -
- **依存**: TASK-011
- **内容**:
  - [ ] ドメイン一覧表示
  - [ ] 追加・編集フォーム
  - [ ] 削除確認ダイアログ
  - [ ] 証明書状態表示

#### TASK-014: Devices画面実装
- **優先度**: P1
- **工数**: 20h
- **担当**: -
- **依存**: TASK-011
- **内容**:
  - [ ] ルール一覧テーブル
  - [ ] フォーム/JSONエディタ切替
  - [ ] インポート/エクスポート
  - [ ] Monaco Editor統合

#### TASK-015: Logs画面実装
- **優先度**: P2
- **工数**: 24h
- **担当**: -
- **依存**: TASK-011
- **内容**:
  - [ ] ログテーブル表示
  - [ ] リアルタイム更新（WebSocket）
  - [ ] フィルタリング機能
  - [ ] エクスポート機能

#### TASK-016: Network画面実装
- **優先度**: P2
- **工数**: 16h
- **担当**: -
- **依存**: TASK-011
- **内容**:
  - [ ] ネットワーク設定表示
  - [ ] メトリクスグラフ
  - [ ] 接続テストUI

#### TASK-017: Settings画面実装
- **優先度**: P2
- **工数**: 20h
- **担当**: -
- **依存**: TASK-011
- **内容**:
  - [ ] タブ切替UI
  - [ ] ユーザー管理
  - [ ] バックアップ/リストア
  - [ ] 詳細設定フォーム

### Phase 4: 運用機能

#### TASK-018: 監視エージェント実装
- **優先度**: P2
- **工数**: 16h
- **担当**: -
- **依存**: TASK-009
- **内容**:
  - [ ] Telegraf設定
  - [ ] メトリクス収集
  - [ ] アラート設定
  - [ ] ダッシュボード連携

#### TASK-019: 自動バックアップ
- **優先度**: P2
- **工数**: 12h
- **担当**: -
- **依存**: TASK-005
- **内容**:
  - [ ] cronジョブ設定
  - [ ] rsync設定
  - [ ] リストアスクリプト
  - [ ] テスト手順書

#### TASK-020: セキュリティ強化
- **優先度**: P1
- **工数**: 20h
- **担当**: -
- **依存**: Phase 1-3完了
- **内容**:
  - [ ] fail2ban設定
  - [ ] nftables強化
  - [ ] セキュリティヘッダー
  - [ ] 脆弱性スキャン

### Phase 5: テスト・デプロイ

#### TASK-021: 単体テスト実装
- **優先度**: P1
- **工数**: 32h
- **担当**: -
- **依存**: 各機能実装後
- **内容**:
  - [ ] APIテスト（Go）
  - [ ] コンポーネントテスト（React）
  - [ ] カバレッジ80%以上

#### TASK-022: 統合テスト
- **優先度**: P1
- **工数**: 24h
- **担当**: -
- **依存**: TASK-021
- **内容**:
  - [ ] E2Eテスト（Playwright）
  - [ ] 負荷テスト
  - [ ] セキュリティテスト

#### TASK-023: デプロイメント準備
- **優先度**: P0
- **工数**: 16h
- **担当**: -
- **依存**: TASK-022
- **内容**:
  - [ ] 本番用ビルドスクリプト
  - [ ] systemdサービス作成
  - [ ] インストーラー作成
  - [ ] アップグレード手順

#### TASK-024: ドキュメント整備
- **優先度**: P1
- **工数**: 20h
- **担当**: -
- **依存**: 全機能完了
- **内容**:
  - [ ] 運用マニュアル
  - [ ] API仕様書
  - [ ] トラブルシューティング
  - [ ] FAQ作成

---

## 3. 進捗管理

### 3.1 完了条件

各タスクは以下を満たした場合に完了とする：
1. 実装完了
2. 単体テスト作成
3. コードレビュー通過
4. ドキュメント更新

### 3.2 進捗記録

## 2025-01-11
### 完了タスク
- TASK-001: プロジェクト初期設定（完了）
  - ディレクトリ構造作成完了
  - .gitignore, package.json, tsconfig.json設定完了
  - TypeScript/ESLint設定完了
  
- TASK-002: 開発環境構築（完了）
  - Docker Compose設定完了
  - 開発用証明書生成スクリプト作成完了
  - Makefile作成完了
  - 開発手順書（README）更新完了

- TASK-003: APIサーバー基盤実装（完了）
  - Goプロジェクト初期化完了
  - HTTPサーバー実装（Gin使用）完了
  - ミドルウェア設定（CORS, Logger, Auth, Security）完了
  - エラーハンドリング基本実装完了
  - ルーティング設定完了

- TASK-004: 認証機能実装（完了）
  - Argon2idハッシュ実装完了
  - JWT生成・検証実装完了
  - ログインAPI実装完了
  - セッション管理実装完了
  - パスワード変更API実装完了

- TASK-005: 設定管理機能（完了）
  - config.json読み書き実装完了
  - JSONスキーマ検証実装完了
  - ホットリロード実装完了
  - バックアップ機能（5世代）実装完了

- TASK-006: Caddy連携実装（完了）
  - Caddy Admin API クライアント実装完了
  - 設定同期機能実装完了
  - 証明書状態取得実装完了
  - エラーリカバリ実装完了

- TASK-007: ルーティング管理API（完了）
  - ドメインCRUD API実装完了
  - デバイスCRUD API実装完了
  - ルール解決ロジック実装完了
  - 設定検証実装完了

- TASK-008: 基本セキュリティルールの実装（完了）
  - LPG自体の基本的なセキュリティルール実装完了
  - DDoS対策の基本ルール実装完了
  - VLANポリシー管理機能を削除（Omada側で管理）

- TASK-009: ログ収集・転送（完了）
  - アクセスログパーサー実装完了
  - JSONフォーマッタ実装完了
  - バッチ送信実装完了
  - ローテーション機能実装完了

- TASK-010: React基盤セットアップ（完了）
  - Vite設定完了
  - React Router設定完了
  - Primer CSS導入完了
  - 認証Context実装完了
  - APIクライアントサービス実装完了
  - グローバルスタイル実装完了
  - 基本コンポーネント（Layout、PrivateRoute）実装完了

### 追加実装項目
- システム情報APIハンドラー実装
  - システム情報取得
  - メトリクス取得
  - ヘルスチェック
  - ネットワーク情報取得

## 2025-07-26
### 追加完了タスク
- **FTPサーバー実装**（追加タスク）
  - vsftpd設定ファイル作成完了
  - FTPSによる暗号化通信実装完了
  - 自動デプロイメント機能実装完了
  - FTPユーザー管理（lacisadmin）設定完了
  - デプロイ監視スクリプト作成完了
  - Dockerコンテナへの統合完了
  - FTPデプロイ手順書作成完了

- **Phase 3: UI実装完了**
  - TASK-011: 共通コンポーネント開発（完了）
    - Layout、PrivateRoute実装済み
    - トースト通知、エラーバウンダリ実装済み
    
  - TASK-012: ログイン画面実装（完了）
    - ログインフォーム実装完了
    - パスワード変更画面実装完了
    - 初回ログイン時の強制パスワード変更機能実装完了
    
  - TASK-013: Domains画面実装（完了）
    - ドメイン一覧表示実装完了
    - 追加・編集・削除機能実装完了
    - 証明書状態表示実装完了
    
  - TASK-014: Devices画面実装（完了）
    - ルーティングルール一覧表示実装完了
    - ルール追加・編集・削除機能実装完了
    - ドメインフィルタリング機能実装完了
    
  - TASK-015: Logs画面実装（完了）
    - アクセスログ表示実装完了
    - リアルタイムストリーミング機能実装完了
    - フィルタリング・検索機能実装完了
    - ログエクスポート機能実装完了
    
  - TASK-016: Network画面実装（完了）
    - システムメトリクス表示実装完了
    - ネットワークインターフェース状態表示実装完了
    - サービスステータス表示実装完了
    - 接続テスト機能実装完了
    
  - TASK-017: Settings画面実装（完了）
    - 一般設定タブ実装完了
    - ユーザー管理タブ実装完了
    - バックアップ管理タブ実装完了
    - 詳細設定（JSONエディタ）タブ実装完了

- **追加実装**
  - NotFoundPage（404ページ）実装完了

### 進行中タスク
なし

### 課題・ブロッカー
- Phase 4（運用機能）の実装が必要
- Phase 5（テスト・デプロイ）の実装が必要
- 本番環境でのパスワード変更が必要（セキュリティ）

### 次のステップ
1. Phase 4: 運用機能の実装
   - TASK-018: 監視エージェント実装
   - TASK-019: 自動バックアップ
   - TASK-020: セキュリティ強化
2. Phase 5: テスト・デプロイ
   - TASK-021: 単体テスト実装
   - TASK-022: 統合テスト
   - TASK-023: デプロイメント準備
   - TASK-024: ドキュメント整備

### Phase 3完了の要点
- **すべてのUI画面が実装完了**
- ログイン、ドメイン管理、デバイス管理、ログ表示、ネットワーク状態、設定管理
- Primer React（GitHub Design System）を使用した統一されたUI
- **FTPサーバーによるデプロイメント機能を追加実装**

## 2025-01-12
### 完了タスク - Phase 4: 運用機能
- **TASK-018: 監視エージェント実装（完了）**
  - Telegraf設定ファイル作成完了
  - システムメトリクス収集設定完了
  - プロセス監視（Caddy、LPG API、vsftpd）設定完了
  - ログ収集・転送機能実装完了
  - ヘルスチェックスクリプト実装完了

- **TASK-019: 自動バックアップ（完了）**
  - バックアップスクリプト実装完了
  - 設定ファイル、ログ、証明書の自動バックアップ機能実装完了
  - 世代管理機能（5世代）実装完了
  - リモートバックアップ対応（rsync/scp）実装完了
  - cron/systemdタイマー設定スクリプト作成完了

- **TASK-020: セキュリティ強化（完了）**
  - セキュリティ強化スクリプト実装完了
  - UFWファイアウォール設定完了
  - fail2ban設定（SSH、FTP、Admin UI、DoS対策）完了
  - SSH強化設定完了
  - カーネルパラメータ最適化完了
  - セキュリティヘッダー（Caddy）実装完了
  - 自動セキュリティアップデート設定完了
  - AIDE（ファイル整合性チェック）設定完了

### Phase 4追加実装
- **Docker統合**
  - Dockerfileへの運用ツール統合完了
  - docker-entrypoint.shへのサービス起動処理追加完了
  - ヘルスチェック設定完了

- **運用コマンド（Makefile）**
  - `make monitor`: 監視状態の確認
  - `make backup`: 手動バックアップ実行
  - `make backup-list`: バックアップ一覧表示
  - `make backup-restore`: バックアップからの復元
  - `make security`: セキュリティ設定の適用
  - `make health-check`: ヘルスチェック実行
  - `make cron-setup`: 定期タスク設定
  - `make logs-all`: すべてのログ表示
  - `make system-info`: システム情報表示

### 進行中タスク
なし

### 課題・ブロッカー
- Phase 5（テスト・デプロイ）の実装が必要
- 本番環境でのパスワード変更が必要（セキュリティ）
- 一部のセキュリティ設定はDockerコンテナ内では制限がある

### 次のステップ
1. Phase 5: テスト・デプロイ
   - TASK-021: 単体テスト実装
   - TASK-022: 統合テスト
   - TASK-023: デプロイメント準備
   - TASK-024: ドキュメント整備

### Phase 4完了の要点
- **完全な運用機能の実装**
- Telegrafによるメトリクス収集・監視
- 自動バックアップとリストア機能
- 包括的なセキュリティ強化
- 運用を支援するMakefileコマンド群
